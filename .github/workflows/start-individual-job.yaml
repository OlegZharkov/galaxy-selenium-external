name: Run ivdividual Selenium Test

on:
  repository_dispatch

jobs:
  run-selenium:
    name: Selenium Run
    runs-on: ubuntu-20.04
    strategy:
          matrix:
            python-version: [3.8]
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
        with:
          submodules: true

      - name: Cache multiple paths
        uses: actions/cache@v2
        with:
          path: |
            galaxy/.venv/
          key: ${{ runner.os }}-selenium

      - name: Run ${{ github.event.client_payload.galaxy_selenium_test_path }}
        env:
           GALAXY_SELENIUM_TEST: ${{ github.event.client_payload.galaxy_selenium_test_path }}
           GALAXY_TEST_SELENIUM_USER_EMAIL: ${{ ${{ secrets.GALAXY_TEST_SELENIUM_USER_EMAIL }} }}
           GALAXY_TEST_SELENIUM_USER_PASSWORD: ${{ ${{ secrets.GALAXY_TEST_SELENIUM_USER_PASSWORD }} }}
        run: |
           echo $GALAXY_SELENIUM_TEST
           cd galaxy && GALAXY_SKIP_CLIENT_BUILD=1 GALAXY_TEST_EXTERNAL=https://usegalaxy.org/ ./run_tests.sh -selenium $GALAXY_SELENIUM_TEST